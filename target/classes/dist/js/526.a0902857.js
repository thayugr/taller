"use strict";(self["webpackChunkweb"]=self["webpackChunkweb"]||[]).push([[526,559,586],{655:function(e,l,a){a.d(l,{D3:function(){return t},Hz:function(){return i},hh:function(){return r},mg:function(){return u},yH:function(){return d}});var o=a(6381);function r(e){return(0,o.A)({url:"/api/sys/role/table",method:"get",params:e})}function t(e){return(0,o.A)({url:"/api/sys/role/edit",method:"post",data:e})}function u(e){return(0,o.A)({url:"/api/sys/role/menu/edit",method:"post",data:e})}function d(e){return(0,o.A)({url:"/api/sys/role/del",method:"delete",params:e})}function i(e){return(0,o.A)({url:"/api/sys/role/menu/list",method:"get",params:e})}},4526:function(e,l,a){a.r(l),a.d(l,{default:function(){return b}});var o=a(4220),r=a(6732),t=a(6559),u=a(9586),d=a(655),i=a(7939),n=a(7251),s=a(7918);const c={class:"searchDiv"};var p={__name:"index",setup(e){const l=(0,r.Kh)({blurry:"",tableData:[],roleId:null,roleObj:{}}),a=(0,r.KR)(!1),p=(0,r.KR)(!1);(0,o.sV)(()=>{m()});const m=()=>{(0,d.hh)({blurry:l.blurry}).then(e=>{e.success?l.tableData=e.data:(0,i.aJ)(e.msg)})},b=e=>{a.value=!0,l.roleObj=e.id?e:{}},f=e=>{p.value=!0,l.roleId=e},g=(e,l)=>{s.s.confirm("Confirmar para eliminar rol 【"+l+"】？","Pista",{confirmButtonText:"Seguro",cancelButtonText:"Cancelar",type:"warning"}).then(()=>{(0,d.yH)({id:e}).then(e=>{e.success?((0,i.j3)(e.data),m()):(0,i.aJ)(e.msg)})}).catch(()=>{(0,i.SV)("operacion cancelada")})};return(e,d)=>{const i=(0,o.g2)("el-input"),s=(0,o.g2)("el-button"),h=(0,o.g2)("el-table-column"),v=(0,o.g2)("el-table");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("div",c,[(0,o.bF)(i,{class:"searchInput",modelValue:l.blurry,"onUpdate:modelValue":d[0]||(d[0]=e=>l.blurry=e),placeholder:"Por favor ingrese un nombre o código de rol",clearable:""},null,8,["modelValue"]),(0,o.bF)(s,{type:"primary",onClick:m},{default:(0,o.k6)(()=>[...d[3]||(d[3]=[(0,o.eW)("Consulta",-1)])]),_:1}),(0,r.R1)(n.s)("role:add")?((0,o.uX)(),(0,o.Wv)(s,{key:0,onClick:b,style:{float:"right"}},{default:(0,o.k6)(()=>[...d[4]||(d[4]=[(0,o.eW)("Nuevo",-1)])]),_:1})):(0,o.Q3)("",!0)]),(0,o.bF)(v,{data:l.tableData,"row-key":"id",border:"",height:"calc(100vh - 180px)","max-height":"calc(100vh - 180px)"},{default:(0,o.k6)(()=>[(0,o.bF)(h,{label:"Numero de Serie",type:"index",width:"60"}),(0,o.bF)(h,{label:"Nombre del personaje",prop:"roleName"}),(0,o.bF)(h,{label:"Codigo de Rol",prop:"roleCode"}),(0,o.bF)(h,{label:"Descripcion del Rol",prop:"description"}),(0,o.bF)(h,{label:"Funcionar",prop:"option",width:"220px",align:"center"},{default:(0,o.k6)(e=>[(0,r.R1)(n.s)("role:authorize")?((0,o.uX)(),(0,o.Wv)(s,{key:0,type:"success",onClick:l=>f(e.row.id)},{default:(0,o.k6)(()=>[...d[5]||(d[5]=[(0,o.eW)("Autorizar",-1)])]),_:1},8,["onClick"])):(0,o.Q3)("",!0),(0,r.R1)(n.s)("role:edit")?((0,o.uX)(),(0,o.Wv)(s,{key:1,type:"primary",onClick:l=>b(JSON.parse(JSON.stringify(e.row)))},{default:(0,o.k6)(()=>[...d[6]||(d[6]=[(0,o.eW)("Editar",-1)])]),_:1},8,["onClick"])):(0,o.Q3)("",!0),(0,r.R1)(n.s)("role:del")?((0,o.uX)(),(0,o.Wv)(s,{key:2,type:"danger",onClick:l=>g(e.row.id,e.row.roleName)},{default:(0,o.k6)(()=>[...d[7]||(d[7]=[(0,o.eW)("Borrar",-1)])]),_:1},8,["onClick"])):(0,o.Q3)("",!0)]),_:1})]),_:1},8,["data"]),(0,o.bF)((0,r.R1)(t["default"]),{"dialog-visible":a.value,"onUpdate:dialogVisible":d[1]||(d[1]=e=>a.value=e),"role-obj":l.roleObj,onGetList:m},null,8,["dialog-visible","role-obj"]),(0,o.bF)((0,r.R1)(u["default"]),{"auth-visible":p.value,"onUpdate:authVisible":d[2]||(d[2]=e=>p.value=e),"role-id":l.roleId},null,8,["auth-visible","role-id"])])}}};const m=p;var b=m},6559:function(e,l,a){a.r(l),a.d(l,{default:function(){return p}});var o=a(4220),r=a(6732),t=a(9798),u=a(655),d=a(7939),i=a(7251),n={__name:"editRole",props:{dialogVisible:{type:Boolean,require:!0,default:!1},roleObj:Object},emits:["update:dialogVisible","get-list"],setup(e,{emit:l}){const a=e,n=l,s=(0,o.EW)({get:()=>a.dialogVisible,set:e=>n("update:dialogVisible",e)}),c=(0,r.KR)(!1),p=(0,r.Kh)({title:"Nuevo",roleForm:{id:null,roleName:"",roleCode:"",description:""},rules:{roleName:[{required:!0,message:"El nombre del rol no puede estar vacío",trigger:"blur"}],roleCode:[{required:!0,message:"El código de rol no puede estar vacío",trigger:"blur"}]}}),m=(0,r.KR)(),b=()=>{(0,i.E)(m.value),p.title="Nuevo",c.value=!1,a.roleObj.id&&(p.title="Editar",p.roleForm=a.roleObj)},f=()=>{m.value.validate(e=>{e&&(c.value=!0,(0,u.D3)(p.roleForm).then(e=>{e.success?((0,d.j3)(e.data),s.value=!1,n("get-list")):(0,d.aJ)(e.msg),c.value=!1}))})};return(e,l)=>{const a=(0,o.g2)("el-input"),u=(0,o.g2)("el-form-item"),d=(0,o.g2)("el-form"),n=(0,o.g2)("el-button"),g=(0,o.g2)("el-dialog");return(0,o.uX)(),(0,o.Wv)(g,{title:p.title,modelValue:s.value,"onUpdate:modelValue":l[5]||(l[5]=e=>s.value=e),draggable:"","close-on-click-modal":!1,onOpened:b},{footer:(0,o.k6)(()=>[(0,o.Lk)("span",null,[(0,o.bF)(n,{onClick:l[4]||(l[4]=e=>(0,r.R1)(i.E)(m.value))},{default:(0,o.k6)(()=>[...l[6]||(l[6]=[(0,o.eW)("reiniciar",-1)])]),_:1}),(0,o.bF)(n,{type:"primary",loading:c.value,onClick:f},{default:(0,o.k6)(()=>[...l[7]||(l[7]=[(0,o.eW)("seguro",-1)])]),_:1},8,["loading"])])]),default:(0,o.k6)(()=>[(0,o.bF)(d,{model:p.roleForm,rules:e.rules,ref_key:"roleRef",ref:m,"label-width":"120px"},{default:(0,o.k6)(()=>[(0,o.bo)((0,o.bF)(u,{prop:"id"},{default:(0,o.k6)(()=>[(0,o.bF)(a,{modelValue:p.roleForm.id,"onUpdate:modelValue":l[0]||(l[0]=e=>p.roleForm.id=e)},null,8,["modelValue"])]),_:1},512),[[t.aG,!1]]),(0,o.bF)(u,{label:"Nombre del personaje",prop:"roleName"},{default:(0,o.k6)(()=>[(0,o.bF)(a,{modelValue:p.roleForm.roleName,"onUpdate:modelValue":l[1]||(l[1]=e=>p.roleForm.roleName=e),placeholder:"Por favor ingrese un nombre de rol"},null,8,["modelValue"])]),_:1}),(0,o.bF)(u,{label:"Codigo de Rol",prop:"roleCode"},{default:(0,o.k6)(()=>[(0,o.bF)(a,{modelValue:p.roleForm.roleCode,"onUpdate:modelValue":l[2]||(l[2]=e=>p.roleForm.roleCode=e),placeholder:"Por favor ingrese el código de rol"},null,8,["modelValue"])]),_:1}),(0,o.bF)(u,{label:"Descripción del rol",prop:"roleIds"},{default:(0,o.k6)(()=>[(0,o.bF)(a,{type:"textarea",modelValue:p.roleForm.description,"onUpdate:modelValue":l[3]||(l[3]=e=>p.roleForm.description=e),"aria-placeholder":"Por favor ingrese una descripción del rol"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])}}},s=a(1317);const c=(0,s.A)(n,[["__scopeId","data-v-32befa84"]]);var p=c},9586:function(e,l,a){a.r(l),a.d(l,{default:function(){return s}});a(4645),a(4564),a(4329);var o=a(4220),r=a(3503),t=a(655),u=a(7939),d=a(6732),i={__name:"authorizeRole",props:{authVisible:{type:Boolean,require:!0,default:!1},roleId:Number},emits:["update:authVisible"],setup(e,{emit:l}){const a=e,i=l,n=(0,o.EW)({get:()=>a.authVisible,set:e=>i("update:authVisible",e)}),s=(0,d.KR)(!1),c=(0,d.KR)(),p=(0,d.Kh)({treeData:[],authorizeData:[],defaultProps:{children:"children",label:"name"}}),m=()=>{s.value=!1,p.authorizeData=[],f()},b=()=>{(0,r.Yd)({}).then(e=>{e.success?p.treeData=e.data:(0,u.aJ)(e.msg)})},f=()=>{(0,t.Hz)({roleId:a.roleId}).then(e=>{e.success?(e.data&&e.data.length>0&&e.data.forEach(e=>{p.authorizeData.push(e.menuId)}),setTimeout(()=>{b()},10)):(0,u.aJ)(e.msg)})},g=()=>{s.value=!0,(0,t.mg)({roleId:a.roleId,menuIds:c.value.getCheckedKeys()}).then(e=>{e.success?((0,u.j3)(e.data),n.value=!1):(0,u.aJ)(e.msg),s.value=!1})};return(e,l)=>{const a=(0,o.g2)("el-tree"),r=(0,o.g2)("el-button"),t=(0,o.g2)("el-dialog");return(0,o.uX)(),(0,o.Wv)(t,{title:"Autorizar",modelValue:n.value,"onUpdate:modelValue":l[1]||(l[1]=e=>n.value=e),draggable:"","close-on-click-modal":!1,onOpened:m},{footer:(0,o.k6)(()=>[(0,o.Lk)("span",null,[(0,o.bF)(r,{onClick:l[0]||(l[0]=e=>n.value=!1)},{default:(0,o.k6)(()=>[...l[2]||(l[2]=[(0,o.eW)("Cancelar",-1)])]),_:1}),(0,o.bF)(r,{type:"primary",loading:s.value,onClick:g},{default:(0,o.k6)(()=>[...l[3]||(l[3]=[(0,o.eW)("Autorizar",-1)])]),_:1},8,["loading"])])]),default:(0,o.k6)(()=>[(0,o.bF)(a,{data:p.treeData,ref_key:"tree",ref:c,"show-checkbox":"","node-key":"id",props:p.defaultProps,"default-expand-all":"","default-checked-keys":p.authorizeData},null,8,["data","props","default-checked-keys"])]),_:1},8,["modelValue"])}}};const n=i;var s=n}}]);
//# sourceMappingURL=526.a0902857.js.map