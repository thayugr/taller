"use strict";(self["webpackChunkweb"]=self["webpackChunkweb"]||[]).push([[513,588],{366:function(e,r,a){a.d(r,{A:function(){return n}});var l=a(4220),t=a(6732),u={__name:"Pagination",props:{current:{type:Number,default:1},size:{type:Number,default:10},total:{type:Number,default:0}},emits:["update:current","update:size","get-list"],setup(e,{emit:r}){const a=e,u=r;let o=(0,l.EW)({get:()=>a.current,set:e=>u("update:current",e)}),n=(0,l.EW)({get:()=>a.size,set:e=>u("update:size",e)});const s=(0,l.EW)(()=>a.total),i=e=>{n.value=e,u("get-list")},d=e=>{o.value=e,u("get-list")};return(e,r)=>{const a=(0,l.g2)("el-pagination");return(0,l.uX)(),(0,l.Wv)(a,{onSizeChange:i,onCurrentChange:d,"current-page":(0,t.R1)(o),"page-sizes":[10,20,50,100,200,500,1e3],"page-size":(0,t.R1)(n),layout:"total, sizes, prev, pager, next, jumper",total:s.value},null,8,["current-page","page-size","total"])}}};const o=u;var n=o},655:function(e,r,a){a.d(r,{D3:function(){return u},Hz:function(){return s},hh:function(){return t},mg:function(){return o},yH:function(){return n}});var l=a(6381);function t(e){return(0,l.A)({url:"/api/sys/role/table",method:"get",params:e})}function u(e){return(0,l.A)({url:"/api/sys/role/edit",method:"post",data:e})}function o(e){return(0,l.A)({url:"/api/sys/role/menu/edit",method:"post",data:e})}function n(e){return(0,l.A)({url:"/api/sys/role/del",method:"delete",params:e})}function s(e){return(0,l.A)({url:"/api/sys/role/menu/list",method:"get",params:e})}},8207:function(e,r,a){a.r(r),a.d(r,{default:function(){return m}});a(4564),a(7578);var l=a(4220),t=a(6732),u=a(9798),o=a(1571),n=a(655),s=a(7939),i=a(7251),d={__name:"editUser",props:{dialogVisible:{type:Boolean,required:!0,default:!1},userObj:Object},emits:["update:dialogVisible","get-list"],setup(e,{emit:r}){const a=e,d=r,c=(0,l.EW)({get:()=>a.dialogVisible,set:e=>d("update:dialogVisible",e)}),p=(0,t.KR)(!1),m=(0,t.KR)(),b=(0,t.Kh)({title:"Nuevo",userForm:{id:null,username:"",nickName:"",roleIds:[]},rules:{username:[{required:!0,message:"El nombre de usuario no puede estar vacío",trigger:"blur"}],nickName:[{required:!0,message:"El apodo del usuario no puede estar vacío",trigger:"blur"}],roleIds:[{required:!0,message:"El rol de usuario no puede estar vacío",trigger:"change"}]},roleList:[]}),g=()=>{(0,i.E)(m.value),b.title="Nuevo",f(),p.value=!1,a.userObj.id&&(b.title="Editar",b.userForm=a.userObj,b.userForm.roleIds=b.userForm.roleIds[0].split(","),b.userForm.roleIds=b.userForm.roleIds.map(Number))},f=()=>{(0,n.hh)({}).then(e=>{e.success?b.roleList=e.data:(0,s.aJ)(e.msg)})},v=()=>{console.log("INSERTAR"),m.value.validate(e=>{e&&(p.value=!0,(0,o.gw)(b.userForm).then(e=>{e.success?((0,s.j3)(e.data),console.log(e.data),c.value=!1,d("get-list")):(0,s.aJ)(e.msg),p.value=!1}))})};return(e,r)=>{const a=(0,l.g2)("el-input"),o=(0,l.g2)("el-form-item"),n=(0,l.g2)("el-option"),s=(0,l.g2)("el-select"),d=(0,l.g2)("el-form"),f=(0,l.g2)("el-button"),k=(0,l.g2)("el-dialog");return(0,l.uX)(),(0,l.Wv)(k,{title:b.title,modelValue:c.value,"onUpdate:modelValue":r[5]||(r[5]=e=>c.value=e),"close-on-click-modal":!1,onOpened:g},{footer:(0,l.k6)(()=>[(0,l.Lk)("span",null,[(0,l.bF)(f,{onClick:r[4]||(r[4]=e=>(0,t.R1)(i.E)(m.value))},{default:(0,l.k6)(()=>[...r[6]||(r[6]=[(0,l.eW)("reiniciar",-1)])]),_:1}),(0,l.bF)(f,{type:"primary",loading:p.value,onClick:v},{default:(0,l.k6)(()=>[...r[7]||(r[7]=[(0,l.eW)("seguro",-1)])]),_:1},8,["loading"])])]),default:(0,l.k6)(()=>[(0,l.bF)(d,{model:b.userForm,rules:b.rules,ref_key:"userRef",ref:m,"label-width":"120px"},{default:(0,l.k6)(()=>[(0,l.bo)((0,l.bF)(o,{prop:"id"},{default:(0,l.k6)(()=>[(0,l.bF)(a,{modelValue:b.userForm.id,"onUpdate:modelValue":r[0]||(r[0]=e=>b.userForm.id=e)},null,8,["modelValue"])]),_:1},512),[[u.aG,!1]]),(0,l.bF)(o,{label:"nombre de usuario",prop:"username"},{default:(0,l.k6)(()=>[(0,l.bF)(a,{modelValue:b.userForm.username,"onUpdate:modelValue":r[1]||(r[1]=e=>b.userForm.username=e),placeholder:"Por favor ingrese el nombre de usuario"},null,8,["modelValue"])]),_:1}),(0,l.bF)(o,{label:"Apoodo",prop:"nickName"},{default:(0,l.k6)(()=>[(0,l.bF)(a,{modelValue:b.userForm.nickName,"onUpdate:modelValue":r[2]||(r[2]=e=>b.userForm.nickName=e),placeholder:"Por favor ingresa un apodo"},null,8,["modelValue"])]),_:1}),(0,l.bF)(o,{label:"rol de usuario",prop:"roleIds"},{default:(0,l.k6)(()=>[(0,l.bF)(s,{modelValue:b.userForm.roleIds,"onUpdate:modelValue":r[3]||(r[3]=e=>b.userForm.roleIds=e),multiple:"",placeholder:"Por favor seleccione un rol"},{default:(0,l.k6)(()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(b.roleList,(e,r)=>((0,l.uX)(),(0,l.Wv)(n,{key:r,label:e.roleName,value:parseInt(e.id)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])}}},c=a(1317);const p=(0,c.A)(d,[["__scopeId","data-v-a24c4b0e"]]);var m=p},9513:function(e,r,a){a.r(r),a.d(r,{default:function(){return v}});var l=a(4220),t=a(6732),u=a(7700),o=a(8207),n=a(366),s=a(1571),i=a(7939),d=a(7251),c=a(9216),p=a(7918);const m={class:"searchDiv"},b={key:0};var g={__name:"index",setup(e){const r=(0,c.P)(),a=(0,t.Kh)({blurry:"",username:r.userInfo.username,tableData:[],userObj:{},current:1,size:10,total:0}),g=(0,t.KR)(!1);(0,l.sV)(()=>{f()});const f=()=>{const e={blurry:a.blurry,size:a.size,currentPage:a.current};(0,s.aU)(e).then(e=>{e.success&&(a.tableData=e.data.records,a.total=e.data.total)})},v=e=>{g.value=!0,a.userObj=e.id?e:{}},k=(e,r)=>{p.s.confirm("Confirmar para eliminar usuario 【"+r+"】？","pista",{confirmButtonText:"Seguro",cancelButtonText:"Cancelar",type:"warning"}).then(()=>{(0,s.bz)({id:e}).then(e=>{e.success?((0,i.j3)(e.data),f()):(0,i.aJ)(e.msg)})}).catch(()=>{(0,i.SV)("Operacion Cancelada")})},y=e=>{e.enabled=!e.enabled;const r=e.enabled?"permitir":"desactivar",a=e.enabled?"#67C23A":"#F56C6C";p.s.confirm('Seguro <span style="color: '+a+'">'+r+"</span>usuario【"+e.nickName+"】？","pista",{confirmButtonText:"Seguro",cancelButtonText:"Cancelar",type:"warning",dangerouslyUseHTMLString:!0}).then(()=>{(0,s.Pp)(e).then(e=>{e.success?((0,i.j3)(e.data),f()):(0,i.aJ)(e.msg)})}).catch(()=>{(0,i.SV)("Operacion Cancelada")})},F=e=>e?"warning":"success";return(e,r)=>{const s=(0,l.g2)("el-input"),i=(0,l.g2)("el-button"),c=(0,l.g2)("el-table-column"),p=(0,l.g2)("el-tag"),h=(0,l.g2)("el-table");return(0,l.uX)(),(0,l.CE)("div",null,[(0,l.Lk)("div",m,[(0,l.bF)(s,{class:"searchInput",modelValue:a.blurry,"onUpdate:modelValue":r[0]||(r[0]=e=>a.blurry=e),placeholder:"Por favor ingrese nombre de usuario o apodo",clearable:""},null,8,["modelValue"]),(0,l.bF)(i,{type:"primary",onClick:f},{default:(0,l.k6)(()=>[...r[5]||(r[5]=[(0,l.eW)("Consulta",-1)])]),_:1}),(0,t.R1)(d.s)("user:add")?((0,l.uX)(),(0,l.Wv)(i,{key:0,onClick:v,style:{float:"right"}},{default:(0,l.k6)(()=>[...r[6]||(r[6]=[(0,l.eW)("Nuevo",-1)])]),_:1})):(0,l.Q3)("",!0)]),(0,l.bF)(h,{data:a.tableData,"row-key":"id",border:""},{default:(0,l.k6)(()=>[(0,l.bF)(c,{label:"nombre de usuario",prop:"username"}),(0,l.bF)(c,{label:"Apodo",prop:"nickName"}),(0,l.bF)(c,{label:"Role",prop:"roles"}),(0,l.bF)(c,{label:"Estado",prop:"enabled",width:"100"},{default:(0,l.k6)(e=>[e.row.enabled?((0,l.uX)(),(0,l.Wv)(p,{key:0,type:"success"},{default:(0,l.k6)(()=>[...r[7]||(r[7]=[(0,l.eW)("permitir",-1)])]),_:1})):((0,l.uX)(),(0,l.Wv)(p,{key:1,type:"danger"},{default:(0,l.k6)(()=>[...r[8]||(r[8]=[(0,l.eW)("desactivar",-1)])]),_:1}))]),_:1}),(0,l.bF)(c,{label:"funcionar",prop:"option",width:"220px",align:"center"},{default:(0,l.k6)(e=>[e.row.username!==a.username?((0,l.uX)(),(0,l.CE)("span",b,[(0,t.R1)(d.s)("user:enabled")?((0,l.uX)(),(0,l.Wv)(i,{key:0,type:F(e.row.enabled),onClick:r=>y(JSON.parse(JSON.stringify(e.row)))},{default:(0,l.k6)(()=>[(0,l.eW)((0,u.v_)(e.row.enabled?"desactivar":"permitir"),1)]),_:2},1032,["type","onClick"])):(0,l.Q3)("",!0),(0,t.R1)(d.s)("user:edit")?((0,l.uX)(),(0,l.Wv)(i,{key:1,type:"primary",onClick:r=>v(JSON.parse(JSON.stringify(e.row)))},{default:(0,l.k6)(()=>[...r[9]||(r[9]=[(0,l.eW)("editar",-1)])]),_:1},8,["onClick"])):(0,l.Q3)("",!0),(0,t.R1)(d.s)("user:del")?((0,l.uX)(),(0,l.Wv)(i,{key:2,type:"danger",onClick:r=>k(e.row.id,e.row.username)},{default:(0,l.k6)(()=>[...r[10]||(r[10]=[(0,l.eW)("borrar",-1)])]),_:1},8,["onClick"])):(0,l.Q3)("",!0)])):(0,l.Q3)("",!0)]),_:1})]),_:1},8,["data"]),(0,l.bF)((0,t.R1)(n.A),{current:a.current,"onUpdate:current":r[1]||(r[1]=e=>a.current=e),size:a.size,"onUpdate:size":r[2]||(r[2]=e=>a.size=e),total:a.total,"onUpdate:total":r[3]||(r[3]=e=>a.total=e),onGetList:f},null,8,["current","size","total"]),(0,l.bF)((0,t.R1)(o["default"]),{"dialog-visible":g.value,"onUpdate:dialogVisible":r[4]||(r[4]=e=>g.value=e),"user-obj":a.userObj,onGetList:f},null,8,["dialog-visible","user-obj"])])}}};const f=g;var v=f}}]);
//# sourceMappingURL=513.3650b863.js.map